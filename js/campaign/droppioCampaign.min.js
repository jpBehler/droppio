$(document).ready(function(){function t(t){return("0"+t.toString(16)).substr(-2)}function a(a){var o=new Uint8Array((a||40)/2);return window.crypto.getRandomValues(o),Array.from(o,t).join("")}var o=new Campaigns,e={"O+":["O+","O-"],"A+":["A+","A-","O+","O-"],"B+":["B+","B-","O+","O-"],"AB+":["A+","A-","AB+","AB-","B+","B-","O+","O-"],"O-":["O-"],"A-":["A-","O-"],"B-":["B-","O-"],"AB-":["AB-","A-","B-","O-"]};$.post("/",{_xsrf:function(t){var a=document.cookie.match("\\b"+t+"=([^;]*)\\b");return!!a&&a[1]}("_xsrf"),type:"creds"}).done(function(t){if(t=JSON.parse(t),respType=t.type,"creds"==respType){var a=t.dbUser,o=t.dbPass;new PouchDB("campaigns",{auto_compaction:!1,cache:!1,heartbeat:!0}),new PouchDB("https://"+a+":"+o+"@droppio.org:6489/campaigns")}}),$(".datepicker").datepicker({selectMonths:!0,selectYears:15,today:"Today",clear:"Clear",close:"Ok",closeOnSelect:!1}),$(".timepicker").timepicker({defaultTime:"08:00",autoClose:!0,twelvehour:!1,done:"OK",cancel:"Cancelar"}),$("select").formSelect(),campaignsDB.sync(remote_campaignsDB,{live:!0,retry:!0,back_off_function:function(t){return 0==t?1e3:t>=1e3&&t<18e5?1.5*t:t>=18e5?1.1*t:void 0}}).on("paused",function(t){$("#submitCampaign").submit(function(){name=$("#name").val(),lastname=$("#lastname").val(),bloodType=$("#bloodType").val(),dni=$("#dni").val(),status=$("#status").val(),hospital=$("#hospital").val().split("@"),hospitalLocation=hospital[1].split(" "),hospitalLocation={lat:hospitalLocation[0],lon:hospitalLocation[1]},hospital=hospital[0],hospitalStarts=$("#hospitalHoursStart").val(),hospitalEnds=$("#hospitalHoursEnd").val(),hospitalHours=hospitalStarts+" "+hospitalEnds,o.name=name,o.lastname=lastname,o.bloodType=bloodType,o.dni=dni,o.status=status,o.hospital=hospital,o.hospitalHours=hospitalHours,o.createdAt=moment().tz("America/Argentina/Buenos_Aires").valueOf(),o._id=dbUser+a(16),o.compatible=e[o.bloodType],campaignsDB.put(o).then(function(){}).catch(function(){})})}).on("error",function(t){})});