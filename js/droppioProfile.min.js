$(document).ready(function(){function t(){this._jsonified=[],this.bloodType=!1,this.name=!1,this.lastname=!1,this.dni=!1,this.email=!1,this.weight=!1,this.birthDate=!1,this.password=!1,this.toJSON=function(){for(var t in this)this[t].length&&this._jsonified.push({_id:t,value:this[t]});return this._jsonified}}function e(t){i.location={lat:t.coords.latitude,lon:t.coords.longitude}}var i=new t;navigator.geolocation.watchPosition(function(t){e(t)}),$.post("/register",{_xsrf:xsrf_token,type:"creds"}).done(function(t){if(t=JSON.parse(t),respType=t.type,"creds"==respType){var e=t.dbUser,n=t.dbPass,a=new PouchDB("settings"+e,{auto_compaction:!1,cache:!1,heartbeat:!0}),o=new PouchDB("https://"+e+":"+n+"@droppio.org:6489/settings"+e);a.sync(o,{live:!0,retry:!0,back_off_function:function(t){return 0==t?1e3:t>=1e3&&t<18e5?1.5*t:t>=18e5?1.1*t:void 0}}).on("paused",function(t){$("#saveSettings").submit(function(t){i.name=$("#name").val(),i.lastname=$("#lastname").val(),i.bloodType=$("#bloodType").val(),i.dni=$("#dni").val(),i.email=$("#email").val(),i.birthDate=$("#birthDate").val(),i.weight=$("#weight").val(),i.password=$("#password").val();for(var e in i.toJSON())a.get(e._id).then(function(t){t.value=e.value,a.put(t).catch(function(t){})}).catch(function(t){a.put(e).catch(function(t){})})})})}}),$(".datepicker").pickadate({selectMonths:!0,selectYears:15,today:"Today",clear:"Clear",close:"Ok",closeOnSelect:!1}),$("select").material_select()});