$(document).ready(function(){function e(){this._jsonified=[],this._keys=[],this.bloodType=void 0,this.name=void 0,this.lastname=void 0,this.dni=void 0,this.email=void 0,this.weight=void 0,this.birthDate=void 0,this.password=void 0,this.province=void 0,this.toJSON=function(){for(var e in this)null!=this[e]&&-1==e.indexOf("_")&&(this._jsonified[e]=this[e]);return this._jsonified}}function o(e){n.location={lat:e.coords.latitude,lon:e.coords.longitude}}function t(){var e=new google.maps.Geocoder,o=new google.maps.LatLng(n.location.lat,n.location.lon);e.geocode({latLng:o},function(e,o){if(o==google.maps.GeocoderStatus.OK){var t;t=e.length>1?e[1]:e[0],n.province=t.address_components[3].long_name}})}var n=new e;navigator.geolocation.watchPosition(function(e){o(e),n.province&&t()}),$.post("/registerTest",{_xsrf:xsrf_token,type:"creds"}).done(function(e){if(e=JSON.parse(e),respType=e.type,"creds"==respType){var o=e.dbUser,t=e.dbPass,i=new PouchDB("settings"+o,{auto_compaction:void 0,cache:void 0,heartbeat:!0}),s=new PouchDB("https://"+o+":"+t+"@droppio.org:6489/settings"+o),c=new PouchDB("hospitals",{auto_compaction:void 0,cache:void 0,heartbeat:!0}),a=new PouchDB("https://"+o+":"+t+"@droppio.org:6489/hospitals");$("#saveSettings").submit(function(e){e.preventDefault(),n.name=$("#name").val(),n.lastname=$("#lastname").val(),n.bloodType=$("#bloodType").val(),n.dni=$("#dni").val(),n.email=$("#email").val(),n.birthDate=$("#birthDate").val(),n.weight=$("#weight").val(),n.password=$("#password").val(),n.radius=$("#radius").val(),elems=n.toJSON(),keys=Object.keys(elems),"province"in elems&&c.find({selector:{province:n.province}}).then(function(e){console.log(e)}).catch(function(e){console.log(e)}),i.allDocs({include_docs:!0,keys:keys}).then(function(e){e.rows.forEach(function(e){"error"in e?i.put({_id:e.key,value:elems[e.key]}).catch(function(e){}):(doc=e.doc,doc.value=elems[e.key],console.log(doc),i.put(doc).catch(function(e){}))})}).catch(function(e){})}),i.sync(s,{live:!0,retry:!0,back_off_function:function(e){return 0==e?1e3:e>=1e3&&e<18e5?1.5*e:e>=18e5?1.1*e:void 0}}).on("error",function(e){}),c.sync(a,{live:!0,retry:!0,back_off_function:function(e){return 0==e?1e3:e>=1e3&&e<18e5?1.5*e:e>=18e5?1.1*e:void 0}}).on("error",function(e){})}}),$(".datepicker").datepicker({selectMonths:!0,selectYears:15,today:"Today",clear:"Clear",close:"Ok",closeOnSelect:void 0}),$("select").formSelect()});